async function session(){var e=localStorage.getItem("sessid");if(null!=e){var t=await fetch("/api/sessinfo",{method:"GET",headers:{sessid:e,"Content-Type":"application/json"}});if(200==t.status){var s=await t.json();return document.getElementById("dbcodeshow").innerHTML=s[e].insertkey,void document.getElementById("logoutbutton").removeAttribute("hidden")}}localStorage.setItem("stat","invalid"),window.location.href="/login.html"}async function logout(){var e=localStorage.getItem("sessid");await fetch("/api/logout",{method:"GET",headers:{sessid:e}});localStorage.removeItem("sessid"),window.location.href="/"}async function s3run(){var e=document.getElementById("s3log"),t=document.getElementById("s3send"),s=localStorage.getItem("sessid");t.setAttribute("disabled","disabled");var n=await fetch("/api/s3run",{method:"GET",headers:{sessid:s}});401==n.status&&(localStorage.setItem("stat","invalid"),window.location.href="/login.html"),t.removeAttribute("disabled");var a=await n.json();e.innerHTML+=a.message+"\n",e.scrollTop=e.scrollHeight}async function dbsetup(){var e=document.getElementById("dbstartuplog"),t=document.getElementById("dbsetupsend"),s=localStorage.getItem("sessid"),n={host:document.getElementById("dbhost").value,user:document.getElementById("dbuser").value,password:document.getElementById("dbpassword").value,name:document.getElementById("dbname").value};t.setAttribute("disabled","disabled");var a=await fetch("/api/dbconn",{method:"POST",headers:{sessid:s,"Content-Type":"application/json"},body:JSON.stringify(n)});401==a.status&&(localStorage.setItem("stat","invalid"),window.location.href="/login.html"),t.removeAttribute("disabled");var o=await a.json();e.innerHTML+=o.message+"\n",e.scrollTop=e.scrollHeight,a.status}async function dbinsert(){var e=document.getElementById("dbinsertlog"),t=document.getElementById("dbinsertsend"),s=localStorage.getItem("sessid"),n={code:document.getElementById("dbinsertcode").value};t.setAttribute("disabled","disabled");var a=await fetch("/api/dbinsert",{method:"POST",headers:{sessid:s,"Content-Type":"application/json"},body:JSON.stringify(n)});401==a.status&&(localStorage.setItem("stat","invalid"),window.location.href="/login.html"),t.removeAttribute("disabled");var o=await a.json();e.innerHTML+=o.message+"\n",e.scrollTop=e.scrollHeight}async function tokenget(){var e=document.getElementById("tokenlog"),t=document.getElementById("tokenget"),s=localStorage.getItem("sessid");t.setAttribute("disabled","disabled");var n=await fetch("/api/submit",{method:"GET",headers:{sessid:s}});if(401==n.status&&(window.location.href="/login.html"),200!=n.status){t.removeAttribute("disabled");var a=await n.json();e.innerHTML+=a.message+"\n",e.scrollTop=e.scrollHeight}else{a=await n.json();e.innerHTML=a.token}}async function dbstatus(){var e=document.getElementById("dbstatus"),t=localStorage.getItem("sessid"),s=await fetch("/api/dbstatus",{method:"GET",headers:{sessid:t}});401==s.status&&(localStorage.setItem("stat","invalid"),window.location.href="/login.html"),200!=s.status?(e.innerHTML="Offline",e.style.color="red"):(e.innerHTML="Online",e.style.color="green")}async function s3status(){var e=document.getElementById("s3status"),t=localStorage.getItem("sessid"),s=await fetch("/api/s3status",{method:"GET",headers:{sessid:t}});401==s.status&&(localStorage.setItem("stat","invalid"),window.location.href="/login.html"),200!=s.status?(e.innerHTML="Offline",e.style.color="red"):(e.innerHTML="Online",e.style.color="green")}window.addEventListener("load",session),setInterval((()=>dbstatus()),2e3),setInterval((()=>s3status()),2e3),document.getElementById("s3send").addEventListener("click",s3run),document.getElementById("dbsetupsend").addEventListener("click",dbsetup),document.getElementById("dbinsertsend").addEventListener("click",dbinsert),document.getElementById("tokenget").addEventListener("click",tokenget),document.getElementById("logoutbutton").addEventListener("click",logout);